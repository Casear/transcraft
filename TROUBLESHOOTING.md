# TransCraft 翻譯問題疑難排解指南

## 問題：特定網站無法翻譯

如果某個網站無法正常翻譯，請按照以下步驟進行診斷：

### 步驟 1：基本檢查

1. **確認擴充功能已載入**
   - 檢查瀏覽器右上角是否有 TransCraft 圖示
   - 點擊圖示確認設定頁面可以正常開啟

2. **檢查API設定**
   - 開啟擴充功能設定頁面
   - 確認已選擇API服務並輸入有效的API Key
   - 測試API連線是否正常

3. **啟用調試模式**
   - 在設定頁面開啟「調試模式」
   - 重新載入問題頁面
   - 嘗試翻譯並查看瀏覽器開發者工具的控制台訊息

### 步驟 2：運行診斷腳本

我們提供了診斷腳本來分析翻譯問題：

1. **使用通用診斷腳本**
   ```javascript
   // 在瀏覽器控制台執行
   fetch('chrome-extension://[extension-id]/debug-script.js')
     .then(response => response.text())
     .then(script => eval(script));
   ```

2. **或手動複製執行診斷代碼**
   - 開啟開發者工具 (F12)
   - 切換到 Console 標籤
   - 複製並執行 `debug-script.js` 或 `site-specific-debug.js` 中的代碼

### 步驟 3：常見問題分析

#### 問題 A：找不到可翻譯元素
**症狀**：控制台顯示 "Found 0 translatable elements"

**可能原因**：
- 網站使用了非標準的HTML結構（如大量使用DIV/SPAN）
- 內容在iframe中
- 內容是動態載入的
- 元素被過度過濾

**解決方案**：
1. 檢查頁面是否使用iframe
2. 等待頁面完全載入後再嘗試翻譯
3. 如果是DIV/SPAN結構問題，擴充功能已更新以支援更多元素類型

#### 問題 B：API錯誤
**症狀**：出現API相關錯誤訊息

**解決方案**：
- 檢查網路連線
- 驗證API Key是否正確且有效
- 檢查API服務配額是否用盡
- 嘗試切換到其他API服務

#### 問題 C：語言檢測問題
**症狀**：顯示「內容已是目標語言」但實際不是

**解決方案**：
- 在語言檢測彈窗中點擊「強制翻譯」
- 或在設定中暫時關閉語言檢測功能

### 步驟 4：網站特定解決方案

#### 對於 l-tike.com 等票務網站：

這類網站經常使用特殊的DOM結構，我們已經更新了擴充功能來更好地支援：

1. **增加了對DIV和SPAN元素的支援**
2. **改進了元素過濾邏輯**
3. **加強了日本票務網站的相容性**

#### 更新後的功能：
- 支援更多HTML元素類型（包括DIV、SPAN）
- 智慧過濾避免翻譯無關元素
- 更好的容器元素檢測
- 改進的文字長度過濾

### 步驟 5：回報問題

如果問題仍未解決，請提供以下資訊：

1. **基本資訊**
   - 瀏覽器版本
   - 擴充功能版本
   - 問題網站URL

2. **診斷資訊**
   - 調試模式的控制台輸出
   - 診斷腳本的執行結果
   - 任何錯誤訊息的截圖

3. **重現步驟**
   - 詳細描述操作步驟
   - 預期結果 vs 實際結果

## 最新更新 (v1.x.x)

- ✅ 新增對DIV、SPAN、DT、DD元素的翻譯支援
- ✅ 新增對INPUT按鈕元素的翻譯支援（如「詳細はこちら」按鈕）
- ✅ 改進元素過濾邏輯，減少誤判
- ✅ 加強對日本票務網站的相容性
- ✅ 提供詳細的診斷工具
- ✅ 改善容器元素的識別
- ✅ 特殊的INPUT元素翻譯顯示方式

## 開發者選項

如果你是開發者或進階使用者：

1. **手動調整元素選取器**
   - 修改 `js/modules/translationAPI.js` 中的 `blockTags` 陣列
   - 調整過濾邏輯以適應特定網站

2. **自定義CSS選取器**
   - 使用瀏覽器開發者工具識別特定元素
   - 在程式碼中添加網站特定的處理邏輯

3. **調整批次大小**
   - 在設定頁面調整批次處理參數
   - 平衡翻譯速度與穩定性