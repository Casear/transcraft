<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title data-i18n="extension_name">TransCraft</title>
    <link rel="stylesheet" href="css/options.css">
</head>
<body>
    <div class="container">
        <h1 id="settings-title" style="cursor: default; user-select: none;" data-i18n="settings_title">TransCraft Settings</h1>
        
        <!-- Language Selection Section -->
        <div class="section">
            <h2 data-i18n="language_settings">Language Settings</h2>
            <p class="section-description" data-i18n="language_settings_desc">Select the interface language for the extension</p>
            <div class="form-group">
                <label for="interface-language" data-i18n="interface_language">Interface Language</label>
                <select id="interface-language">
                    <option value="en">English</option>
                    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                </select>
            </div>
        </div>
        
        <div class="section">
            <h2 data-i18n="select_translation_service">Select Translation Service</h2>
            <div class="form-group">
                <label for="api-service-select" data-i18n="translation_service">Translation Service</label>
                <select id="api-service-select">
                    <option value="" data-i18n="please_select_service">Please select a service</option>
                    <option value="openai">OpenAI (ChatGPT)</option>
                    <option value="claude">Claude (Anthropic)</option>
                    <option value="gemini">Gemini (Google)</option>
                    <option value="openrouter">OpenRouter</option>
                    <option value="ollama">Ollama (Local)</option>
                </select>
            </div>
        </div>

        <div class="section">
            <h2 id="api-section-title" data-i18n="api_key_settings">API Key Settings</h2>
            <p class="section-description" data-i18n="please_select_service_first">Please select a translation service first, then configure the corresponding API Key</p>
            
            <div class="api-section" id="openai-section" style="display: none;">
                <h3>ğŸ¤– OpenAI API Key</h3>
                <input type="password" id="openai-key" placeholder="sk-proj-...">
                <p class="help-text">
                    å¾ <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a> å–å¾—
                    <br><small>æ”¯æ´ GPT-4oã€GPT-4o Miniã€GPT-3.5 Turbo</small>
                </p>
            </div>

            <div class="api-section" id="claude-section" style="display: none;">
                <h3>ğŸ§  Claude API Key</h3>
                <input type="password" id="claude-key" placeholder="sk-ant-...">
                <p class="help-text">
                    å¾ <a href="https://console.anthropic.com/api-keys" target="_blank">Anthropic Console</a> å–å¾—
                    <br><small>æ”¯æ´ Claude 3.5 Sonnetã€Claude 3 Haiku</small>
                </p>
            </div>

            <div class="api-section" id="gemini-section" style="display: none;">
                <h3>âœ¨ Gemini API Key</h3>
                <input type="password" id="gemini-key" placeholder="AIza...">
                <p class="help-text">
                    å¾ <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a> å–å¾—
                    <br><small>æ”¯æ´ Gemini 1.5 Flashã€Gemini 1.5 Pro</small>
                </p>
            </div>

            <div class="api-section" id="openrouter-section" style="display: none;">
                <h3>ğŸŒ OpenRouter API Key</h3>
                <input type="password" id="openrouter-key" placeholder="sk-or-v1-...">
                <p class="help-text">
                    å¾ <a href="https://openrouter.ai/keys" target="_blank">OpenRouter</a> å–å¾—
                    <br><small>æ”¯æ´ Claudeã€GPTã€Llamaã€Gemini ç­‰å¤šç¨®æ¨¡å‹</small>
                </p>
                <div class="openrouter-setup-info">
                    <details>
                        <summary>âš ï¸ é‡è¦è¨­å®šæ­¥é©Ÿ</summary>
                        <ol>
                            <li><strong>1. ç²å– API Keyï¼š</strong>åˆ° <a href="https://openrouter.ai/keys" target="_blank">OpenRouter Keys</a> å‰µå»º API Key</li>
                            <li><strong>2. é…ç½®éš±ç§è¨­å®šï¼š</strong>åˆ° <a href="https://openrouter.ai/settings/privacy" target="_blank">éš±ç§è¨­å®š</a></li>
                            <li><strong>3. å•Ÿç”¨æ¨¡å‹è¨“ç·´ï¼š</strong>å‹¾é¸ "Allow training on prompts" æˆ–é¡ä¼¼é¸é …</li>
                            <li><strong>4. ä¿å­˜è¨­å®šï¼š</strong>ç¢ºä¿è¨­å®šå·²ä¿å­˜å¾Œå†æ¸¬è©¦é€£æ¥</li>
                            <li><strong>5. ç­‰å¾…ç”Ÿæ•ˆï¼š</strong>è¨­å®šå¯èƒ½éœ€è¦å¹¾åˆ†é˜æ‰æœƒç”Ÿæ•ˆ</li>
                        </ol>
                        <p><small>ğŸ’¡ æ³¨æ„ï¼šå¦‚æœä¸å•Ÿç”¨ prompt trainingï¼ŒæŸäº›å…è²»æ¨¡å‹å°‡ç„¡æ³•ä½¿ç”¨</small></p>
                    </details>
                </div>
            </div>

            <div class="api-section" id="ollama-section" style="display: none;">
                <h3>ğŸ¦™ Ollama æœ¬åœ°æœå‹™</h3>
                <input type="text" id="ollama-key" placeholder="ç„¡éœ€ API Keyï¼ˆæœ¬åœ°é‹è¡Œï¼‰" disabled style="background-color: #f5f5f5;">
                <p class="help-text">
                    è«‹ç¢ºèª <a href="https://ollama.ai" target="_blank">Ollama</a> å·²å®‰è£ä¸¦é‹è¡Œåœ¨ localhost:11434
                    <br><small>æœ¬åœ° AI æ¨¡å‹ï¼Œå®Œå…¨ç§å¯†ï¼Œç„¡éœ€ç¶²è·¯é€£ç·š</small>
                </p>
                <div class="ollama-setup-info">
                    <details>
                        <summary>ğŸ“‹ å¿«é€Ÿè¨­å®šæŒ‡å—</summary>
                        <ol>
                            <li>ä¸‹è¼‰ä¸¦å®‰è£ <a href="https://ollama.ai" target="_blank">Ollama</a></li>
                            <li>é–‹å•Ÿçµ‚ç«¯æ©ŸåŸ·è¡Œï¼š<code>ollama serve</code></li>
                            <li>ä¸‹è¼‰æ¨¡å‹ï¼š<code>ollama pull llama3.1:8b</code></li>
                            <li>æ¸¬è©¦é€£æ¥ï¼š<code>ollama list</code></li>
                        </ol>
                    </details>
                </div>
            </div>

            <div class="no-service-selected" id="no-service-message">
                <div class="placeholder-icon">âš™ï¸</div>
                <p>è«‹å…ˆé¸æ“‡ç¿»è­¯æœå‹™</p>
            </div>
        </div>

        <div class="section">
            <h2 data-i18n="default_settings">Default Settings</h2>
            
            <div class="form-group">
                <label for="target-language" data-i18n="target_language">Target Language</label>
                <select id="target-language">
                    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                    <option value="zh-CN">ç°¡é«”ä¸­æ–‡</option>
                    <option value="en">è‹±æ–‡</option>
                    <option value="ja">æ—¥æ–‡</option>
                    <option value="ko">éŸ“æ–‡</option>
                    <option value="es">è¥¿ç­ç‰™æ–‡</option>
                    <option value="fr">æ³•æ–‡</option>
                    <option value="de">å¾·æ–‡</option>
                </select>
            </div>

            <div class="form-group" id="model-selection-group" style="display: none;">
                <label for="model-select" data-i18n="ai_model">AI Model</label>
                <select id="model-select">
                    <!-- å‹•æ…‹å¡«å……é¸é … -->
                </select>
                <div class="model-info" id="model-info">
                    <!-- å‹•æ…‹é¡¯ç¤ºæ¨¡å‹èªªæ˜ -->
                </div>
            </div>

            <div class="no-model-available" id="no-model-message">
                <div class="placeholder-icon">ğŸ¤–</div>
                <p data-i18n="please_select_service_for_models">Please select a translation service to view available AI models</p>
            </div>
        </div>

        <div class="section">
            <h2 data-i18n="translation_batch_settings">Translation Batch Settings</h2>
            <p class="section-description" data-i18n="batch_settings_desc">Adjust translation processing batch size, affects translation speed and API usage efficiency</p>
            
            <div class="form-group">
                <label for="max-batch-length" data-i18n="batch_max_chars">Batch Maximum Characters</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="number" id="max-batch-length" min="1000" max="60000" step="1000" value="8000" style="flex: 1;">
                    <button type="button" id="auto-adjust-batch-size" class="secondary-button" title="æ ¹æ“šæ‰€é¸æ¨¡å‹è‡ªå‹•èª¿æ•´æ‰¹æ¬¡å¤§å°">
                        ğŸ¯ <span data-i18n="auto_adjust">Auto Adjust</span>
                    </button>
                </div>
                <small class="help-text" data-i18n="batch_max_chars_help">Maximum characters per translation request, range: 1000-60000. Click "Auto Adjust" to optimize batch size based on selected model</small>
            </div>

            <div class="form-group">
                <label for="max-batch-elements" data-i18n="batch_max_elements">Batch Maximum Elements</label>
                <input type="number" id="max-batch-elements" min="1" step="1" value="20">
                <small class="help-text" data-i18n="batch_max_elements_help">Maximum number of elements per translation request, no upper limit, automatically controlled by character count</small>
            </div>

            <div class="form-group">
                <label for="request-timeout" data-i18n="request_timeout">Translation Request Timeout (seconds)</label>
                <input type="number" id="request-timeout" min="15" max="120" step="5" value="60">
                <small class="help-text" data-i18n="request_timeout_help">Maximum wait time for a single translation request, recommended range: 30-60 seconds</small>
            </div>

            <div class="batch-info">
                <div class="info-item">
                    <strong data-i18n="smaller_batches">Smaller Batches:</strong><span data-i18n="smaller_batches">Slower translation speed, but more stable, suitable for complex content</span>
                </div>
                <div class="info-item">
                    <strong data-i18n="larger_batches">Larger Batches:</strong><span data-i18n="larger_batches">Faster translation speed, but may affect quality, suitable for simple content</span>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 data-i18n="expert_mode_management">Expert Mode Management</h2>
            <p class="section-description" data-i18n="expert_mode_desc">Customize translation prompts for different types of content</p>
            
            <div class="expert-modes-list" id="expert-modes-list">
                <!-- å‹•æ…‹å¡«å……å°ˆå®¶æ¨¡å¼åˆ—è¡¨ -->
            </div>
            
            <button id="add-expert-mode-button" class="secondary-button">
                <span>+ æ–°å¢å°ˆå®¶æ¨¡å¼</span>
            </button>
        </div>

        <div class="section" id="debug-section" style="display: none;">
            <h2 data-i18n="debug_mode">ğŸ› Debug Mode</h2>
            <p class="section-description" data-i18n="debug_mode_desc">Developer option - When enabled, detailed debug information will be displayed in the console</p>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="debug-mode-checkbox">
                    <span style="margin-left: 8px;" data-i18n="enable_debug_mode">Enable Debug Mode</span>
                </label>
                <small class="help-text" data-i18n="debug_mode_help">When enabled, API requests/responses, translation process and other detailed information will be logged to browser console</small>
            </div>
        </div>

        <div class="button-group">
            <button id="save-button" class="primary-button" data-i18n="save_settings_btn">Save Settings</button>
            <button id="test-button" class="secondary-button" data-i18n="test_connection_btn">Test Connection</button>
        </div>

        <div id="status-message" class="status-message"></div>
    </div>

    <!-- å°ˆå®¶æ¨¡å¼ç·¨è¼¯æ¨¡æ…‹çª— -->
    <div id="expert-mode-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title" data-i18n="add_expert_mode_title">Add Expert Mode</h3>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="expert-mode-id" data-i18n="mode_id">Mode ID</label>
                    <input type="text" id="expert-mode-id" placeholder="ä¾‹å¦‚: novel, technical, academic">
                    <small class="help-text" data-i18n="mode_id_help">Unique identifier, can only contain English letters, numbers and underscores</small>
                </div>
                
                <div class="form-group">
                    <label for="expert-mode-name" data-i18n="mode_name">Mode Name</label>
                    <input type="text" id="expert-mode-name" placeholder="ä¾‹å¦‚: å°èªªæ¨¡å¼">
                </div>
                
                <div class="form-group">
                    <label for="expert-mode-description" data-i18n="mode_description">Mode Description</label>
                    <input type="text" id="expert-mode-description" placeholder="ä¾‹å¦‚: é©åˆæ–‡å­¸ä½œå“ç¿»è­¯ï¼Œä¿æŒæ–‡å­¸æ€§å’Œæƒ…æ„Ÿè¡¨é”">
                </div>
                
                <div class="form-group">
                    <label for="expert-mode-prompt" data-i18n="system_prompt">System Prompt</label>
                    <textarea id="expert-mode-prompt" rows="8" placeholder="ä¾‹å¦‚: You are a literary translator specializing in novels and creative works. Translate the following text to {targetLanguage}..."></textarea>
                    <small class="help-text" data-i18n="system_prompt_help">Use {targetLanguage} as a placeholder for the target language</small>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="secondary-button" data-i18n="cancel">Cancel</button>
                <button id="modal-save" class="primary-button" data-i18n="save">Save</button>
            </div>
        </div>
    </div>

    <script src="js/i18n.js"></script>
    <script src="js/options.js"></script>
</body>
</html>